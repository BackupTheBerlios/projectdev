# $Id: PKGBUILD,v 1.1 2004/11/02 13:04:41 dpb Exp $
# Maintainer: judd <jvinet@zeroflux.org>
pkgname=pacman
pkgver=2.9.2
pkgrel=1
pkgdesc="A .tar.gz based package manager with dependency support"
url="http://www.archlinux.org/pacman"
backup=('etc/pacman.conf' 'etc/makepkg.conf' 'etc/abs/abs.conf' \
        etc/pacman.d/{current,release,extra,unstable})
makedepends=('libtar')
install=pacman.install
source=(ftp://ftp.archlinux.org/other/pacman/$pkgname-$pkgver.tar.gz \
  http://www.archlinux.org/pacman/sortmirrors.pl \
  supfile.arch supfile.extra supfile.unstable abs abs.conf \
  current release extra unstable)
md5sums=('f73ed0d84573dfc8fdab541ce55447bd' '005d82a4832b5273450e556f30010414'\
         '2c564a8760ec0dac96082f1855d153d1' 'f83885f6c431e4e7f8b131fe444ac0d2'\
         '9a44663da93a07c8df42741ea0e41930' '0025f9f786d50201951fc7444207a089'\
         '5dfcce0aa5e121936c002e555d6fb55e' '3d6287d2892d541168ec288bdeb66d81'\
         '82a317a88a041729ca3887e1b3dcfa8c' '0fa3c4c249ff1f97c90977f86687bb40'\
         '082c25bc59de91a366de4768babc01ad')

build() {
  cd $startdir/src/$pkgname-$pkgver
  ./configure --prefix=/usr
  make || return 1
  make DESTDIR=$startdir/pkg install
  mkdir -p $startdir/pkg/var/abs/local
  install -D -m755 ../sortmirrors.pl $startdir/pkg/usr/bin/sortmirrors.pl
  install -D -m755 ../abs $startdir/pkg/usr/bin/abs
  install -D -m644 ../abs.conf $startdir/pkg/etc/abs/abs.conf
  for fn in supfile.{arch,extra,unstable}; do
    install -D -m644 ../$fn $startdir/pkg/etc/abs/$fn
  done
  for fn in current release extra unstable; do
    install -D -m644 ../$fn $startdir/pkg/etc/pacman.d/$fn
  done
  sed -i "s|i686|$CARCH|g" $startdir/pkg/etc/pacman.d/*
}
