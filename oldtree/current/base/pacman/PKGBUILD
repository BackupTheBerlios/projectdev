# $Id: PKGBUILD,v 1.3 2004/11/03 13:57:21 dpb Exp $
# Maintainer: judd <jvinet@zeroflux.org>
pkgname=pacman
pkgver=2.9.2
pkgrel=1
pkgdesc="A .tar.gz based package manager with dependency support"
url="http://www.archlinux.org/pacman"
backup=('etc/pacman.conf' 'etc/makepkg.conf' 'etc/abs/abs.conf' \
        etc/pacman.d/{current,release,extra,unstable})
makedepends=('libtar')
install=pacman.install
source=(ftp://ftp.archlinux.org/other/pacman/$pkgname-$pkgver.tar.gz \
  http://www.archlinux.org/pacman/sortmirrors.pl \
  supfile.current supfile.extra supfile.unstable abs abs.conf \
  current release extra unstable)
md5sums=('f73ed0d84573dfc8fdab541ce55447bd' '005d82a4832b5273450e556f30010414'\
         '60a48a96b40cec638d52b09c0d014351' 'f83885f6c431e4e7f8b131fe444ac0d2'\
         '9a44663da93a07c8df42741ea0e41930' '0025f9f786d50201951fc7444207a089'\
         '0e858d0d4f366b055a21e9ad8a88be51' '318b31c1611f4a89172e6bf84691b7c2'\
         '729f595e06cda73d1c0218ca0bad7c7a' 'a6d98e7679f4d2de6aedc9862cc940ca'\
         '16e9a835e75abc8d8a65987881e16ab2')

build() {
  cd $startdir/src/$pkgname-$pkgver
  ./configure --prefix=/usr
  make || return 1
  make DESTDIR=$startdir/pkg install
  mkdir -p $startdir/pkg/var/abs/local
  install -D -m755 ../sortmirrors.pl $startdir/pkg/usr/bin/sortmirrors.pl
  install -D -m755 ../abs $startdir/pkg/usr/bin/abs
  install -D -m644 ../abs.conf $startdir/pkg/etc/abs/abs.conf
  for fn in supfile.{current,extra,unstable}; do
    install -D -m644 ../$fn $startdir/pkg/etc/abs/$fn
  done
  for fn in current release extra unstable; do
    install -D -m644 ../$fn $startdir/pkg/etc/pacman.d/$fn
  done
  sed -i "s|i686|$CARCH|g" $startdir/pkg/etc/pacman.d/*
}
